<% content_for :stylesheets do %>
  <%= stylesheet_link_tag 'views/dashboard/dashboard' %>
<% end %>
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <title>Dashboard Joia do Saber</title>
</head>
<body>
<header class="header3">
  <div id="logo">Joia do Saber</div>
  <div id="username">
    <i class='bx bxs-user-circle' style="font-size: 4.438rem; color: #413B3B; cursor: pointer"></i><strong style="cursor: pointer;"><%= @current_user.name %>&nbsp;</strong> <i class='bx bxs-down-arrow' style="font-size: 12px; cursor: pointer"><div class="dropdown_menu" style="display: none"><ul>Sair</ul></div></i>
  </div>
</header>
<div id="content">
  <aside>
    <div id="profile">
      <div>
        <i class='bx bxs-user-circle' style="font-size: 4.6875rem; color: #424F3C"></i>
      </div>
      <div>
        <h4 id="uuser"><%= @current_user.name %></h4>
        <strong><b>&#9679;</b> Online</strong>
      </div>
    </div>

    <h5>Gerenciar</h5>

    <nav class="nav_dashboard">
      <ul>
        <li><%= link_to dashboard_path do %><i class='bx bx-home'></i>&nbsp;Home<% end %></li>
        <li><%= link_to dashboard_book_path do %><i class='bx bx-book'></i>&nbsp;Gerenciar Livros<% end %></li>
        <li><%= link_to dashboard_author_path do %><i class='bx bx-user-circle' ></i>&nbsp;Gerenciar Autores<% end %></li>
        <li><%= link_to dashboard_supplier_path do %><i class='bx bx-wrench'></i>&nbsp;Gerenciar Fornecedores<% end %></li>
        <li><%= link_to dashboard_account_path do %><i class='bx bx-wallet'></i>&nbsp;Contas de Fornecedores<% end %></li>
        <li><%= link_to dashboard_part_path do %><i class='bx bx-cog' ></i>&nbsp;Gerenciar Peças<% end %></li>
        <li><%= link_to dashboard_assembly_path do %><i class='bx bx-layer'></i>&nbsp;Montagens<% end %></li>
      </ul>
    </nav>
  </aside>
  <main>
    <h2>Verificar Livros</h2>

    <div class="table_information">
      <div class="table_data">
        <table class="table_data_content">
          <thead>
            <tr>
              <th colspan="3" class="text-left table-title">
                Gerenciar Livros
              </th>
              <th colspan="2" style="text-align: right">
                <%= link_to 'Adicionar Livro', dashboard_book_path, class: 'button_action green' %>
                <%= link_to 'Editar', '#', class: 'button_action blue',  id: 'edit-selected-button'%>
                <%= link_to 'Apagar', dashboard_assembly_path, class: 'button_action red' %>
              </th>
            </tr>
          </thead>
          <tbody>
            <% @books.each do |book| %>
              <tr>
                <td style="text-align: center"><%= check_box_tag 'book_ids[]', book.id, false, class: 'check_id'%></td>
                <td><%= book.title %></td>
                <td><%= book.published_at %></td>
                <td><%= book.author.name %></td>
                <td><%= book.isbn %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </main>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $('#edit-selected-button').on('click', function(e) {
            e.preventDefault();

            // Captura IDs dos checkboxes selecionados
            var selectedIds = $('input[name="book_ids[]"]:checked').map(function(){
                return $(this).val();
            }).get();

            // Redireciona para a página de edição com os IDs como parâmetros
            if(selectedIds.length > 0) {
                $(window).attr("location", parseInt(selectedIds) + "/edit");
            } else {
                alert('Por favor, selecione pelo menos um registro para editar.');
            }
        });
    });
</script>
</body>
</html>